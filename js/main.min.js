function saveFile(){fileName=Math.random().toString(36).substring(1)+"_file.txt";var t=new Blob([textarea.value],{type:"text/plain;charset=utf-8"});saveAs(t,fileName)}function handleFileSelect(t){t.stopPropagation(),t.preventDefault();var e=t.dataTransfer.files,n=new FileReader;n.onload=function(t){textarea.value=t.target.result},n.readAsText(e[0],"UTF-8")}function handleDragOver(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy"}var textarea=document.querySelector("#textarea"),filename=document.querySelector("#input-name"),save=document.querySelector(".js-save"),area=textarea,fileName,preview=document.querySelector(".preview");save.addEventListener("click",saveFile),area.value||(area.value=window.localStorage.getItem("value")),textarea.addEventListener("keyup",function(){window.localStorage.setItem("value",area.value)},!1),function(){var t,e,n,i=function(t,e){return function(){return t.apply(e,arguments)}};t={tab:9,enter:13,ctrl:17,space:32,b:66,i:73,u:85,q:81},e=function(){function e(e,n){var r,o;for(this.el=e,this.options=n,this.onPressTab=i(this.onPressTab,this),this.selectionBegin=this.selectionEnd=0,this.tabSpaces="",r=0,o=this.options.tabSize;0<=o?r<o:r>o;0<=o?++r:--r)this.tabSpaces+=" ";this.options.convertSheetToTable&&this.el.addEventListener("paste",function(t){return function(e){var n,i,r,o,a,s;if(e.clipboardData&&e.clipboardData.items){for(t.clearPastedStrings(),r={},o=0,a=(s=e.clipboardData.items).length;o<a;o++)"string"===(i=s[o]).kind&&/^text\/(plain|html)$/.test(i.type)&&(r[i.type]=i);return r["text/plain"]&&r["text/html"]&&r["text/plain"].getAsString&&r["text/html"].getAsString?(e.preventDefault(),"function"==typeof(n=t.options).beforePastedObjectToTable&&n.beforePastedObjectToTable(e),t.getPastedString(r["text/plain"]),t.getPastedString(r["text/html"])):void 0}}}(this)),this.el.addEventListener("keydown",function(e){return function(n){var i,r,o,a;if(n.keyCode!==t.enter||n.shiftKey||(e.options.list&&e.supportInputListFormat(n),e.options.table&&e.supportInputTableFormat(n),e.options.codeblock&&e.supportCodeblockFormat(n)),n.keyCode===t.space&&n.shiftKey&&!n.ctrlKey&&!n.metaKey){if(a=e.getTextArray(),o=e.getCurrentLine(a),e.options.list&&e.toggleCheck(n,a,o),e.options.autoTable&&e.makeTable(n,a,o),e.options.csvToTable&&e.csvToTable(e.getSelectedText(),a))return n.preventDefault(),void("function"==typeof(i=e.options).onMadeTable&&i.onMadeTable(n));if(e.options.tsvToTable&&e.tsvToTable(e.getSelectedText(),a))return n.preventDefault(),void("function"==typeof(r=e.options).onMadeTable&&r.onMadeTable(n));e.options.sortTable&&e.sortTable(n,a,o),e.options.tableFunction&&e.tableFunction(n,a,o)}if(n.keyCode===t.tab&&e.onPressTab(n),n.ctrlKey&&!n.metaKey&&!n.shiftKey&&n.which!==t.ctrl)return e.withCtrl(n)}}(this))}var n,r,o,a,s,l,u,c,p,h,g,f,d,v;return u=/^(\s*(-|\*|\+|\d+?\.)\s+(\[(\s|x)\]\s+)?)(\S*)/,l=/^\s{0,3}\s*((-\s+-\s+-(\s+-)*)|(\*\s+\*\s+\*(\s+\*)*))\s*$/,g=/^\s{0,3}\|(.*?\|)+\s*$/,f=/^\s{0,3}\|(\s*(:-{2,}|-{2,}:|:-{1,}:|-{3,})\s*\|)+\s*$/,o=/^\s{0,3}\|(\s*?\|)+\s*$/,n=/^\s{0,3}((```+)|(~~~+))(\S*\s*)$/,a=/^\s{0,3}((```+)|(~~~+))$/,c=/^(:?)(\d+)x(\d+)(:?)$/,p=/^-?\d+[\d\.]*$/,s=/^=\s*(\S+)\s*$/,h=/<meta[^>]+?generator[^>]+?>/i,r=/\scontent=['"]?([^'"]+)['"]?/i,v=/^Sheets$|^LibreOffice|^Microsoft Excel|^OpenOffice/,d=["sum","average","max","min","count"],e.prototype.clearPastedStrings=function(){return this.pastedStrings={}},e.prototype.getTextArray=function(){return this.getText().split("")},e.prototype.getText=function(){return this.el.value},e.prototype.supportInputListFormat=function(t){var e,n,i,r,o,a;if(a=this.getTextArray(),!(n=this.getCurrentLine(a)).match(l)&&(r=n.match(u))&&(o=this.getSelectionStart(),!a[o]||"\n"===a[o])){if(!(r[5].length<=0))return i=t.ctrlKey?this.tabSpaces:"",this.insert(a,"\n"+i+r[1]),t.preventDefault(),"function"==typeof(e=this.options).onInsertedList?e.onInsertedList(t):void 0;this.removeCurrentLine(a)}},e.prototype.toggleCheck=function(t,e,n){var i,r,o;if((r=n.match(u))&&r[4])return i="",i="x"===r[4]?n.replace("[x]","[ ]"):n.replace("[ ]","[x]"),o=this.getSelectionStart(),this.replaceCurrentLine(e,o,n,i),t.preventDefault()},e.prototype.replaceCurrentLine=function(t,e,n,i){var r;return r=this.getPosBeginningOfLine(t,e),this.replace(t,i,r,r+n.length)},e.prototype.supportInputTableFormat=function(t){var e,n,i,r,a,s,l,u,c,p,h,f,d,v,S;if(S=this.getTextArray(),n=this.replaceEscapedPipe(this.getCurrentLine(S)),d=this.getSelectionStart(),n.match(g)&&!this.isTableHeader(S)&&d!==this.getPosBeginningOfLine(S,d)){if(!n.match(o)||!this.isTableBody(S)){for(t.preventDefault(),f=-1,i=0,a=n.length;i<a;i++)"|"===n[i]&&f++;if(u=this.getPosEndOfLine(S),v="",!this.isTableBody(S))for(v="\n|",r=0,c=f;0<=c?r<c:r>c;0<=c?++r:--r)v+=" "+this.options.tableSeparator+" |";for(h="\n|",s=0,p=f;0<=p?s<p:s>p;0<=p?++s:--s)h+="  |";return this.insert(S,v+h,u),l=u+v.length+h.length-3*f+1,this.setSelectionRange(l,l),"function"==typeof(e=this.options).onInsertedTable?e.onInsertedTable(t):void 0}this.removeCurrentLine(S)}},e.prototype.supportCodeblockFormat=function(t){var e,i,r,o,a;if(a=this.getTextArray(),o=this.getSelectionStart(),i=this.getCurrentLine(a),r=i.match(n),(!a[o+1]||"\n"===a[o+1])&&r&&this.requireCodeblockEnd(a,o))return t.preventDefault(),this.insert(a,"\n\n"+r[1]),this.setSelectionRange(o+1,o+1),"function"==typeof(e=this.options).onInsertedCodeblock?e.onInsertedCodeblock(t):void 0},e.prototype.requireCodeblockEnd=function(t,e){var i,r,o;if(i=this.isInnerCodeblock(t,e))return!1;for(o=this.getPosBeginningOfLine(t,e);o<=t.length;){if(r=this.getCurrentLine(t,o),i&&r.match(a))return!1;!i&&r.match(n)&&(i=!0),o+=r.length+1}return!0},e.prototype.isInnerCodeblock=function(t,e){var i,r,o,s;for(null==e&&(e=this.getSelectionStart()),r=!1,s=0,i=this.getPosBeginningOfLine(t,e)-1;s<i;)o=this.getCurrentLine(t,s),r&&o.match(a)?r=!1:!r&&o.match(n)&&(r=!0),s+=o.length+1;return r},e.prototype.makeTable=function(t,e,n){var i,r,o,a,s,l;if(!this.isSelectRange()&&(a=n.match(c))&&!(a[2]<=0||a[3]<=0))return t.preventDefault(),i=!!a[1].length,r=!!a[4].length,l=this.buildTable(a[2],a[3],{alignLeft:i,alignRight:r}),s=this.getPosBeginningOfLine(e),this.replaceCurrentLine(e,s,n,l),this.setSelectionRange(s+2,s+2),"function"==typeof(o=this.options).onMadeTable?o.onMadeTable(t):void 0},e.prototype.buildTable=function(t,e,n){var i,r,o,a,s,l,u,c,p,h;for(null==n&&(n={}),p="---",n.alignLeft&&(p=":"+p),n.alignRight&&(p+=":"),h="|",i=0,s=t;0<=s?i<s:i>s;0<=s?++i:--i)h+="  |";for(h+="\n|",r=0,l=t;0<=l?r<l:r>l;0<=l?++r:--r)h+=" "+p+" |";for(o=0,u=e-1;0<=u?o<u:o>u;0<=u?++o:--o)for(h+="\n|",a=0,c=t;0<=c?a<c:a>c;0<=c?++a:--a)h+="  |";return h},e.prototype.csvToTable=function(t,e,n){return null==e&&(e=this.getTextArray()),null==n&&(n=!1),this.separatedStringToTable(t,",",e,n)},e.prototype.tsvToTable=function(t,e,n){return null==e&&(e=this.getTextArray()),null==n&&(n=!1),this.separatedStringToTable(t,"\t",e,n)},e.prototype.separatedStringToTable=function(t,e,n,i){var r,o,a,s,l,u,c,p,h,g,f;for(l=!1,a=!1,o=[[""]],f=0,h=0,g=0,s=u=0,c=(t=t.replace(/\r\n/g,"\n").replace(/\r/g,"\n")).length;u<c;s=++u)r=t[s],l?a?(a=!1,o[f][h]+=r):a||'"'!==r?o[f][h]+=r:'"'===t[s+1]?a=!0:l=!1:'"'===r?l=!0:r===e?(o[f].push(""),g<(h+=1)&&(g=h)):"\n"===r?(o.push([""]),f+=1,h=0):o[f][h]+=r;return!(i&&g<=0&&f<=0||!i&&g<=0)&&(p=this.createTableFromArray(o),this.replace(n,p,this.getSelectionStart(),this.getSelectionEnd()),!0)},e.prototype.createTableFromArray=function(t){var e,n,i,r,o,a,s,l,u,c;for(c="",n=i=0,o=t.length;i<o;n=++i)if(1!==(s=t[n]).length||""!==s[0]){for(c+="|",r=0,a=s.length;r<a;r++)e=s[r],c+=" "+this.trim(e).replace(/\n/g,"<br>")+" |";if(c+="\n",0===n){for(c+="|",l=0,u=s.length;0<=u?l<u:l>u;0<=u?++l:--l)c+=" "+this.options.tableSeparator+" |";c+="\n"}}return c},e.prototype.getPastedString=function(t){var e;return e=t.type,t.getAsString(function(t){return function(n){return t.onGetPastedString(e,n)}}(this))},e.prototype.onGetPastedString=function(t,e){var n,i,o;{if(e)return this.pastedStrings[t]=e,this.pastedStrings["text/plain"]&&this.pastedStrings["text/html"]?((o=this.pastedStrings["text/html"].match(h))&&(i=o[0].match(r))?(n=i[1],v.test(n)&&this.tsvToTable(this.pastedStrings["text/plain"],null,!0)||this.restorePlainText()):this.restorePlainText(),this.clearPastedStrings()):void 0;this.clearPastedStrings()}},e.prototype.restorePlainText=function(){return this.replace(this.getTextArray(),this.pastedStrings["text/plain"],this.getSelectionStart(),this.getSelectionEnd())},e.prototype.tableFunction=function(t,e,n){var i,r,o,a,l,u,c,p,h,g,f;if(!this.isSelectRange()&&(i=this.getCurrentCol(e,n)-1,g=this.getCurrentRow(e),!(i<0)&&null!=g&&(t.preventDefault(),o=this.getCurrentTableData(e),"string"==typeof(r=o.lines[g].values[i])&&(p=r.match(s)))))for(l=p[1],a=new RegExp("^"+l+"$","i"),u=0,c=d.length;u<c;u++)if((f=d[u]).match(a))return void(null!=(h=this[f+"TableFunction"](o,i,g))&&this.replaceCurrentCol(e,h))},e.prototype.countTableFunction=function(t,e,n){return t.lines.length-1},e.prototype.maxTableFunction=function(t,e,n){var i,r,o,a,s,l;for(a=-1/0,i=0,r=(l=t.lines).length;i<r;i++)"number"==typeof(o=l[i]).values[e]&&a<o.values[e]?a=o.values[e]:null!=(s=parseFloat(o.values[e]))&&!isNaN(s)&&a<s&&(a=s);return a===-1/0?null:a},e.prototype.round=function(t){var e;return e=Math.pow(10,this.options.significantFigures),Math.round(t*e)/e},e.prototype.minTableFunction=function(t,e,n){var i,r,o,a,s,l;for(a=1/0,i=0,r=(l=t.lines).length;i<r;i++)"number"==typeof(o=l[i]).values[e]&&a>o.values[e]?a=o.values[e]:null!=(s=parseFloat(o.values[e]))&&!isNaN(s)&&a>s&&(a=s);return a===1/0?null:a},e.prototype.averageTableFunction=function(t,e,n){return this.round(this.sumTableFunction(t,e,n)/this.countTableFunction(t,e,n))},e.prototype.sumTableFunction=function(t,e,n){var i,r,o,a,s,l;for(l=0,i=0,r=(s=t.lines).length;i<r;i++)"number"==typeof(o=s[i]).values[e]?l+=o.values[e]:null==(a=parseFloat(o.values[e]))||isNaN(a)||(l+=a);return this.round(l)},e.prototype.replaceCurrentCol=function(t,e,n){var i,r;for(null==n&&(n=this.getSelectionStart()),r=n,i=n;r>0&&"|"!==t[r-1];)r--;for(;t[i]&&"|"!==t[i];)i++;return this.replace(t," "+e+" ",r,i,!0)},e.prototype.sortTable=function(t,e,n){var i,r,o,a,s,l,u,c,p,h,g,f;if(!this.isSelectRange()&&this.isTableHeader(e)){for(t.preventDefault(),h=this.getSelectionStart(),a=this.getCurrentCol(e,n)-1,s=this.getCurrentTableData(e),i=!1,l=u=1,g=s.lines.length;1<=g?u<g:u>g;l=1<=g?++u:--u)if(0<this.compare(s.lines[l-1].values[a],s.lines[l].values[a])){i=!0;break}for(s.lines.sort(function(t){return function(e,n){return t.compare(e.values[a],n.values[a],i)}}(this)),o="",c=0,p=(f=s.lines).length;c<p;c++)o+=f[c].text+"\n";return this.replace(e,o,s.bodyStart,s.bodyEnd),this.setSelectionRange(h,h),"function"==typeof(r=this.options).onSortedTable?r.onSortedTable(t):void 0}},e.prototype.compare=function(t,e,n){var i;return null==n&&(n=!0),i=n?1:-1,this.isEmpty(t)?-1*i:this.isEmpty(e)?1*i:t===e?0:(t<e?-1:1)*i},e.prototype.getCurrentCol=function(t,e){var n,i,r,o,a,s;for(s=this.replaceEscapedPipe(e),o=this.getSelectionStart()-this.getPosBeginningOfLine(t,this.getSelectionStart()),n=0,i=r=0,a=Math.min(o,s.length);0<=a?r<a:r>a;i=0<=a?++r:--r)"|"===s[i]&&n++;return n},e.prototype.getCurrentRow=function(t,e){var n,i;for(null==e&&(e=this.getSelectionStart()),e=this.getPosEndOfLine(t,e)-1,i=0,n=this.getCurrentLine(t,e);this.replaceEscapedPipe(n).match(g);)e-=n.length+1,n=this.getCurrentLine(t,e),i++;return i<3?null:i-3},e.prototype.isEmpty=function(t){return null===t||void 0===t||""===t},e.prototype.getTableStart=function(t,e){var n;for(null==e&&(e=this.getSelectionStart()),e=this.getPosEndOfLine(t,e)-1,n=this.getCurrentLine(t,e);this.replaceEscapedPipe(n).match(g);)e-=n.length+1,n=this.getCurrentLine(t,e);return e+2},e.prototype.isTableLine=function(t){return t.match(g)},e.prototype.getCurrentTableData=function(t,e){var n,i,r,o,a,s,l,u,c;for(null==e&&(e=this.getSelectionStart()),e=this.getTableStart(t,e),l=2;l>0&&null!=t[e];)"\n"===t[e]&&l--,e++;for(i={bodyStart:e,lines:[]};null!=t[e]&&this.isTableBody(t,e)&&!((s=this.getCurrentLine(t,e-1)).length<=0);){for(r=o=0,a=(c=this.replaceEscapedPipe(s.slice(1,-1)).split("|")).length;o<a;r=++o)u=c[r],c[r]=this.trim(u),("function"==typeof(n=c[r]).match?n.match(p):void 0)&&(c[r]=+c[r]);i.lines.push({text:s,values:c}),e+=s.length+1}return i.bodyEnd=e,i},e.prototype.trim=function(t){return t.replace(/^\s+/,"").replace(/\s+$/,"")},e.prototype.isSelectRange=function(){return this.getSelectionStart()!==this.getSelectionEnd()},e.prototype.getSelectedText=function(){return this.getText().slice(this.getSelectionStart(),this.getSelectionEnd())},e.prototype.setSelectionRange=function(t,e){return this.selectionBegin=t,this.selectionEnd=e,this.el.setSelectionRange(this.selectionBegin,this.selectionEnd)},e.prototype.replaceEscapedPipe=function(t){return t.replace(/\\\|/g,"..")},e.prototype.isTableHeader=function(t,e){return null==t&&(t=this.getTextArray()),null==e&&(e=this.getSelectionStart()),e=this.getPosEndOfLine(t,e),!!this.getCurrentLine(t,e).match(f)},e.prototype.isTableBody=function(t,e){var n;for(null==t&&(t=this.getTextArray()),null==e&&(e=this.getSelectionStart()-1),n=this.replaceEscapedPipe(this.getCurrentLine(t,e));n.match(g)&&e>0;){if(n.match(f))return!0;e=this.getPosBeginningOfLine(t,e)-2,n=this.replaceEscapedPipe(this.getCurrentLine(t,e))}return!1},e.prototype.getPrevLine=function(t,e){return null==e&&(e=this.getSelectionStart()-1),e=this.getPosBeginningOfLine(t,e),this.getCurrentLine(t,e-2)},e.prototype.getPosEndOfLine=function(t,e){for(null==e&&(e=this.getSelectionStart());t[e]&&"\n"!==t[e];)e++;return e},e.prototype.getPosBeginningOfLine=function(t,e){for(null==e&&(e=this.getSelectionStart());t[e-1]&&"\n"!==t[e-1];)e--;return e},e.prototype.getPosBeginningOfLines=function(t,e,n){var i,r,o,a,s;if(null==e&&(e=this.getSelectionStart()),null==n&&(n=this.getSelectionEnd()),i=[this.getPosBeginningOfLine(t,e)],(e=this.getPosEndOfLine(e)+1)<n)for(o=r=a=e,s=n;(a<=s?r<=s:r>=s)&&t[o];o=a<=s?++r:--r)o>0&&"\n"===t[o-1]&&i.push(o);return i},e.prototype.getCurrentLine=function(t,e){var n,i,r;for(null==t&&(t=this.getText()),null==e&&(e=this.getSelectionStart()-1),r=e,i="";t[r]&&"\n"!==t[r];)i=""+t[r]+i,r--;for(r=e+1,n="";t[r]&&"\n"!==t[r];)n=""+n+t[r],r++;return""+i+n},e.prototype.removeCurrentLine=function(t){var e,n;return n=this.getPosEndOfLine(t),e=this.getPosBeginningOfLine(t),this.replace(t,"",e,n)},e.prototype.onPressTab=function(t){if(t.preventDefault(),!this.options.table||!this.moveCursorOnTableCell(t))return this.options.tabToSpace?this.tabToSpace(t):void 0},e.prototype.withCtrl=function(e){if(this.options.fontDecorate)return null!=function(){switch(e.which){case t.b:return this.wrap("**");case t.i:return this.wrap("_");case t.u:return this.wrap("~~");case t.q:return this.wrap("`")}}.call(this)?e.preventDefault():void 0},e.prototype.wrap=function(t){var e,n,i,r;if(i=this.getSelectionStart(),n=this.getSelectionEnd(),i!==n)return r=this.getTextArray(),!(this.getPosBeginningOfLines(r,i,n).length>1)&&(e=r.slice(i,n).join(""),this.replace(r,""+t+e+t,i,n),this.setSelectionRange(i+t.length,n+t.length),!0)},e.prototype.moveCursorOnTableCell=function(t){var e;return e=this.replaceEscapedPipe(this.getText()),!!this.getCurrentLine(e).match(g)&&(t.shiftKey?this.moveToPrevCell(e):this.moveToNextCell(e),!0)},e.prototype.tabToSpace=function(t){var e,n,i,r;return r=this.getTextArray(),i=this.getSelectionStart(),(e=this.getPosBeginningOfLines(r,i)).length<=1?(n=this.getCurrentLine(r,e[0]),this.options.list&&n.match(u)&&!n.match(l)?this.insertSpacesToBeginningOfLines(r,i,e,t.shiftKey):t.shiftKey?void 0:this.insert(r,this.tabSpaces)):this.insertSpacesToBeginningOfLines(r,i,e,t.shiftKey)},e.prototype.insertSpacesToBeginningOfLines=function(t,e,n,i){var r,o,a,s,l,u,c,p,h,g,f,d;for(p=[],a=0,l=0,c=n.length;l<c;l++)if(g=n[l],g+=a,o=this.getCurrentLine(t,g),p.push(g),i)0===o.indexOf(this.tabSpaces)&&(t.splice(g,this.options.tabSize),a-=this.options.tabSize);else{for(s=u=0,f=this.options.tabSize;0<=f?u<f:u>f;s=0<=f?++u:--u)t.splice(g,0," ");a+=this.options.tabSize}if(this.el.value=t.join(""),p.length>1)return this.setSelectionRange(p[0],this.getPosEndOfLine(t,p[p.length-1]));if(a<0)for(r=this.getPosBeginningOfLine(t,e+a),s=h=-1,d=-this.options.tabSize;-1<=d?h<=d:h>=d;s=-1<=d?++h:--h)if((!t[e+s]||"\n"===t[e+s])&&p[0]>r){e=p[0]-a;break}return this.setSelectionRange(e+a,e+a)},e.prototype.moveToPrevCell=function(t,e){var n,i,r,o,a,s;for(null==e&&(e=this.getSelectionStart()-1),r=!1,o=!1,n=e;t[n];){if(r&&n<0||!r&&n<=0)return!1;if(o&&" "!==t[n]&&"|"!==t[n])return!1;if(r){if(" "!==t[n]){if("\n"!==t[n]){"|"===t[n]&&n++," "===t[n]&&n++;break}r=!1,o=!0}}else"|"===t[n]&&(r=!0,o=!1);n--}if(n<0)return!1;for(s=a=n,i=!1;t[a]&&"|"!==t[a];)" "!==t[a]&&(s=a,i||(n++,i=!0)),a--;return this.setSelectionRange(s,n),!0},e.prototype.moveToNextCell=function(t,e){var n,i,r,o,a;for(null==e&&(e=this.getSelectionStart()),r=!1,o=!1,n=null,a=e;t[a];){if(a>0&&"\n"===t[a-1]&&"|"!==t[a]){n=--a;break}if(r)if(" "!==t[a]){if("\n"!==t[a])break;r=!1}else{if(o)break;o=!0}else"|"===t[a]&&(r=!0);a++}if(t[a]||(n=--a),!n)for(n=i=a;t[i]&&"|"!==t[i];)" "!==t[i]&&(n=i+1),i++;return this.setSelectionRange(a,n),!0},e.prototype.insert=function(t,e,n){return null==n&&(n=this.getSelectionStart()),this.replace(t,e,n,n)},e.prototype.replace=function(t,e,n,i,r){var o;null==r&&(r=!1),this.setSelectionRange(n,i);try{o="function"==typeof document.execCommand?document.execCommand("insertText",!1,e):void 0}catch(t){o=!1}if(o||this.replaceValue(t,e,n,i),r)return this.setSelectionRange(n,n+e.length)},e.prototype.replaceValue=function(t,e,n,i){var r;t.splice(n,i-n,e);try{document.execCommand("ms-beginUndoUnit")}catch(t){t}this.el.value=t.join("");try{document.execCommand("ms-endUndoUnit")}catch(t){t}return r=n+e.length,this.setSelectionRange(r,r)},e.prototype.getSelectionStart=function(){return this.el.selectionStart},e.prototype.getSelectionEnd=function(){return this.el.selectionEnd},e.prototype.destroy=function(){return this.el.removeEventListener("keydown"),this.el.dataset.markdownEditor=null,this.el=null},e.prototype.startUpload=function(t){var e,n,i;return i=this.getTextArray(),n=this.getSelectionStart(),e=this.buildUploadingText(t),n>0&&"\n"!==i[n-1]&&(e="\n"+e),n<i.length-1&&"\n"!==i[n]&&(e+="\n"),this.replaceValue(i,e,n,n)},e.prototype.cancelUpload=function(t){return this.el.value=this.getText().replace(this.buildUploadingText(t),"")},e.prototype.buildUploadingText=function(t){return this.options.uploadingFormat(t)},e.prototype.finishUpload=function(t,e){var n,i,r,o,a;return null==e&&(e={}),r=this.getText(),((n=e.text||"").length<=0&&e.url||e.alt)&&(n="!["+(e.alt||"")+"]("+(e.url||"")+")",null!=e.href&&(n="["+n+"]("+e.href+")")),o=this.buildUploadingText(t),(a=r.indexOf(o))>=0?(this.getSelectionStart(),this.getSelectionEnd(),this.replaceValue(this.getTextArray(),n,a,a+o.length)):(i=this.getSelectionStart(),this.replaceValue(this.getTextArray(),n,i,i))},e}(),n={tabSize:4,onInsertedList:null,onInsertedTable:null,onInsertedCodeblock:null,onSortedTable:null,onMadeTable:null,convertSheetToTable:!0,tabToSpace:!0,list:!0,table:!0,fontDecorate:!0,codeblock:!0,autoTable:!0,tableSeparator:"---",csvToTable:!0,tsvToTable:!0,sortTable:!0,tableFunction:!0,significantFigures:4,beforePastedObjectToTable:null,uploadingFormat:function(t){return"![Uploading... "+t+"]()"}},window.markdownEditor=function(t,i){var r,o;null==i&&(i={});for(r in n)o=n[r],null==i[r]&&(i[r]=o);return new e(t,i)}}.call(this),options={},markdownEditor(textarea,options),preview.innerHTML=marked(textarea.value),textarea.addEventListener?textarea.addEventListener("input",function(){preview.innerHTML=marked(textarea.value)},!1):textarea.attachEvent&&textarea.attachEvent("onpropertychange",function(){preview.innerHTML=marked(textarea.value)}),textarea.addEventListener("dragover",handleDragOver,!1),textarea.addEventListener("drop",handleFileSelect,!1);